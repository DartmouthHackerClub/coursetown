function sort_divs(e){var t;switch(sortby){case"course":t=function(e,t){e=$(e),t=$(t);var n=e.attr("data-department"),r=t.attr("data-department");return n<r?-1:n>r?1:e.attr("data-number")-t.attr("data-number")};break;case"time":t=function(e,t){function n(e){switch(e){case"8":return 0;case"9":return 1;case"9L":return 1;case"9S":return 1;case"10":return 2;case"10A":return 2;case"11":return 3;case"12":return 4;case"2":return 5;case"2A":return 5;case"3A":return 6;case"3B":return 6;default:return 7}}return n($(e).attr("data-period"))-n($(t).attr("data-period"))};break;case"median":t=function(e,t){return amed=$(e).attr("data-avg-median"),bmed=$(t).attr("data-avg-median"),!amed&&!bmed?0:amed?bmed?bmed-amed:-1:1};break;default:alert("invalid sorting id, something went wrong")}return e.sort(t)}function loading(){$("#loading_results").show(),$("#the_results").hide(),$("#no_results").hide()}function hide_loading(){$("#loading_results").hide()}function show_results(e){last_result=e,hide_loading(),e.length<=0?($("#no_results").show(),$("#the_results").hide()):($("#no_results").hide(),$("#the_results").show(),e=sort_divs(e),$("#the_results").html(e));return}function show_error(e){return result_div=$('<div class="error_msg"><h3>OH NOES! AN ERROR!</h3><h4>Shield Your Eyes:</h4><div>'),result_div.append(JSON.stringify(e)),$("#the_results").html(result_div),!0}function get_department_number(e){return dept_map&&dept_map[e]?dept_map[e].id:-1}function generate_input_field_quarter(){date=new Date,this_year=date.getFullYear(),years=[this_year,this_year+1];var e="";e+='<select name="term">',e+='<option value="F">Fall</option>',e+='<option value="W">Winter</option>',e+='<option value="S">Spring</option>',e+='<option value="X">Summer</option>',e+="</select>",e+='<select name="year">';for(key in years)year=years[key],e+='<option value="'+year+'">'+year+"</option>";return e+="</select>",e}function generate_input_field_time(){times=["8","9","9L","9S","10","11","12","2","10A","2A","3A","3B"],html="",html+='<span style="font-size: .7em;">';for(key in times)time=times[key],html+='<input type="checkbox" name="period_'+time+'" id="period_'+time+'" value="1" /><label for="period_'+time+'">'+time+"</label>";return html+="&nbsp;&nbsp;&nbsp;",html+='<a href="#" class="check_all">ALL</a>',html+="&nbsp;&nbsp;&nbsp;",html+='<a href="#" class="check_none">NONE</a>',html+="</span>",html}function generate_input_field_distrib(){distribs=["ART","LIT","TMV","INT","SOC","QDS","SCI","SLA","TAS","TLA"],html="",html+='<span style="font-size: .7em;">';for(key in distribs)distrib=distribs[key],html+='<input type="checkbox" name="distrib_'+distrib+'" id="distrib_'+distrib+'" value="1" /><label for="distrib_'+distrib+'">'+distrib+"</label>";return html+="&nbsp;&nbsp;&nbsp;",html+='<a href="#" class="check_all">ALL</a>',html+="&nbsp;&nbsp;&nbsp;",html+='<a href="#" class="check_none">NONE</a>',html+="</span>",html}function make_left_side_dropdown(){var e=$('<select name="criteria"></select>'),t=$('<option value="null">---Choose Criteria---</option>');e.append(t);for(var n in search_options){var r=search_options[n],i=$("<option></option>");i.attr("value",n),i.html(r.long_name),e.append(i)}return e.change(function(){choice=$(this).val(),old_value=e.data("old_value"),e.data("old_value",choice);if(choice=="null"){var t="";$(this).data("is_empty")||(empty_rows++,$(this).data("is_empty",!0))}else{$(this).children('[value="null"]').hide(),search_options[choice].in_use=!0;var t=search_options[choice].input_field;$(this).data("is_empty")&&(empty_rows--,$(this).data("is_empty",!1))}old_value&&(search_options[old_value].in_use=!1);var n=$(this).parents("fieldset.search_row").find(".right_side");n.html(t),add_search_row_if_we_need_one()}),e.data("is_empty",!0),e.mouseenter(function(){for(n in search_options)search_options[n].in_use?$(this).find("option[value='"+n+"']").hide():$(this).find("option[value='"+n+"']").show()}),e}function add_search_row_if_we_need_one(){while(empty_rows<=0)insert_search_row_dom_element();$(".check_all").click(function(){$(this).parent().children("input").attr("checked",!0)}),$(".check_none").click(function(){$(this).parent().children("input").attr("checked",!1)}),$(".close_row").click(function(){left_side=$(this).parent(),left_side.find("select option:selected").removeAttr("selected"),left_side.find("select option[value='title']").attr("selected","selected"),left_side.find("select").change(),left_side.parent().hide()}),$('input[id="title"]').autocomplete({source:"/courses.json"}),$('input[id="prof"]').autocomplete({source:"/professors.json"}),$('input[id="dept"]').autocomplete({source:"/departments.json"})}function make_search_row_dom_element(){return row=$(' <fieldset class="search_row"> </fieldset> '),left_side=$(' <fieldset class="left_side"> </fieldset> '),close_link=$('<a href="#" class="close_row">X</a>'),dropdown=make_left_side_dropdown(),left_side.append(dropdown),right_side=$(' <fieldset class="right_side"></fieldset> '),row.append(left_side),row.append(right_side),row.append(close_link),row[0]}function get_search_form(){return $("#search_form")}function insert_search_row_dom_element(){return row=make_search_row_dom_element(),get_search_form().find(".rows").append(row),$(row).wrap("<p>"),empty_rows++,row}function removeDups(e){var t=[];for(var n=e.length;n--;){var r=e[n];$.inArray(r,t)===-1&&t.unshift(r)}return t}var empty_rows=0,query_url="http://hacktown.cs.dartmouth.edu/search/courses/courses/_search",search_query_url="/search_json",d1=null,last_result=null,sortby="course";JSON={},JSON.stringify=JSON.stringify||function(e){var t=typeof e;if(t!="object"||e===null)return t=="string"&&(e='"'+e+'"'),String(e);var n,r,i=[],s=e&&e.constructor==Array;for(n in e)r=e[n],t=typeof r,t=="string"?r='"'+r+'"':t=="object"&&r!==null&&(r=JSON.stringify(r)),i.push((s?"":'"'+n+'":')+String(r));return(s?"[":"{")+String(i)+(s?"]":"}")},JSON.parse=JSON.parse||jsonParse;var search_options={Professors:{long_name:"Professor",input_field:'<input type="text" name="Professors" id="Professors" value=""/>'},title:{long_name:"Title",input_field:'<input type="text" name="title" id="title" value=""/>'},department:{long_name:"Department",input_field:'<input type="text" name="department" id="dept" value=""/>'},Number:{long_name:"Course Number",input_field:'<input type="text" name="Number" id="Number" value=""/>'},description:{long_name:"Course Description",input_field:'<input type="text" name="description" id="description" value=""/>'},median_grade:{long_name:"Average Median",input_field:' <select name="avg_median" > <option value="4.00">A</option> <option value="3.66">A- or higher</option> <option value="3.33" selected>B+ or higher</option> <option value="3.0">B or higher</option> <option value="2.66">B- or higher</option> </select> '},wc:{long_name:"World Culture",input_field:'<select name="wc"><option value="W">W</option><option value="NW">NW</option><option value="CI">CI</option></select>'},nro:{long_name:"Can NRO?",input_field:'<input type="checkbox" name="nro" value="true" checked="true"/>Heck Yeah'}};$().ready(function(){$.browser.msie&&($("#results_container").append('<h1><a href="http://getfirefox.com">Get Firefox</a> or <a href="http://google.com/chrome">Get Chrome</a></h1>'),alert("Course picker isn't written for Internet Explorer and may not work correctly.")),loading(),hide_loading(),search_params={size:9e3},$.ajax({dataType:"json",type:"POST",url:search_query_url,data:JSON.stringify(search_params),success:function(e){profs=removeDups($.map(e,function(e){return e._source.Professors})),titles=removeDups($.map(e,function(e){return e._source.title}))},error:function(e){}}),dept_abbrevs=[];for(key in dept_map)dept_abbrevs.push(key),dept_abbrevs.push(dept_map[key].name);for(key in search_options)search_options[key].in_use=!1;row1=insert_search_row_dom_element(),row1=$(row1),row1.find("select option:selected").removeAttr("selected"),row1.find("select option[value='title']").attr("selected","selected"),row1.find("select").change(),$("#search_form").submit(function(e){e.preventDefault();try{the_form=$("#search_form"),loading(),$.ajax({dataType:"html",type:"GET",url:search_query_url,data:the_form.serialize(),success:function(e){show_results($(e).children("div.post"))},error:function(e){show_error(e)}})}catch(t){console.log(t.message)}return!1}),$("input:radio[name=sortby]").change(function(){sortby=$(this).val(),last_result&&(loading(),show_results(last_result))})});