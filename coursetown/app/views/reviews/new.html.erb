<%# HEADER %>

<% if @review.offering %>
	<% courses = @review.offering.courses %>
	<% if courses.empty? || !(courses.first.is_a? Course)%>
		<h1>"New Review for UNKNOWN COURSE"</h1>
	<% else %>
		<h1><%= "New Review for #{courses.first.compact_title}" %></h1>
	<% end %>
	<% if courses.length > 1 %>
		<h3><%= "Cross-listed as: " + courses.map(&compact_title).join(', ') %></h3>
	<% end %>
<% else %>
	<h1>New Review</h1>
<% end %>

<%# COURSE INFO %>

<div id="course_info">
	<% if @review.offering %>
		<%# TODO make names link to their actual pages %>
		<% professors = @review.professors %>
		<%= (professors.length == 1 ? "Instructor: " : "Instructors: ") %>
		<%=	raw professors.map{|prof| 
			link_to(prof.name, prof_reviews_path(:id => prof.id))}.join(', ') %>
		<br/>

		<%# "11F @ 9L" %>
		<%= "#{@review.offering.year}#{@review.offering.term} @ #{@review.offering.time}" %>
		<%# TODO [not when you took this course?] button %>
	<% else %>
		Please select a course offering to review.
	<% end %>
</div>

<%# REVIEW %>

<div>
	<%= form_for @review do |f| %>
	  <%= f.label "Grade" %>
	  <%= f.select :grade, Review.grade_list.reverse %>
	  <br/>

	  <%= f.label "Course" %>
	  <%= star_rating f, :course_rating %>
	  <br/>
	  <%= f.text_area(:course_comment, :rows => 6, :cols => 50,
	  :placeholder => "How interesting, well-paced, and useful was the course? Would you recommend it?") %>
	  <br/>

	  <%= f.label "Professor"%>
	  <%= star_rating f, :prof_rating %>
	  <br/>
	  <%= f.text_area(:prof_comment, :rows => 6, :cols => 50,
	  :placeholder => "How helpful, knowledgeable, and fair #{@review.professors.size > 1 ? 'were the professors' : 'was the professor'}?") %>
	  <br/>

	  <%= f.label "Workload" %>
	  <%= star_rating f, :workload_rating %>
	  <br/>
	  <%= f.text_area(:workload_comment, :rows => 6, :cols => 50,
	  :placeholder => "Was the workload manageable? Consistent throughout the term? Difficult? Did it seem like busy-work? Any tips?") %>
	  <br/>

	  <%= f.hidden_field :offering_id %>

	  <%= f.submit "Submit" %>
	<% end %>
	<%# TODO cancel button? %>
</div>